test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_1_dataset['hill_size_x']
test_dataset_2 = dataset %>% filter(grepl(codes[2], id))
test_dataset_3 = dataset %>% filter(grepl(codes[3], id))
View(test_dataset_1)
require(tidyverse)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
empty_list <- vector(mode = "list", length = 3)
test_dataset[1] = dataset %>% filter(grepl(codes[1], id))
test_dataset[1]['prediction'] = predict(simple_model,test_dataset[1])*test_dataset[1]['hill_size_x']
require(tidyverse)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset <- vector(mode = "list", length = 3)
test_dataset[1] = dataset %>% filter(grepl(codes[1], id))
test_dataset[1]['prediction'] = predict(simple_model,test_dataset[1])*test_dataset[1]['hill_size_x']
test_dataset <- vector(mode = "list", length = 3)
test_dataset[1] = dataset %>% filter(grepl(codes[1], id))
require(tidyverse)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
View(test_dataset_1)
require(tidyverse)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
view(test_dataset_1)
require(tidyverse)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
test_dataset_1
require(tidyverse)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
test_dataset_1['prediction']
all_ratings <- read.csv("all_ratings.csv")
all_comps_r <- read.csv("all_comps_r.csv")
all_results <- read.csv("all_results.csv")
all_results <- read.csv("all_names.csv")
all_results <- all_results[all_results['speed']>50 & all_results['speed']<115,]
all_ratings <- read.csv("all_ratings.csv")
all_comps_r <- read.csv("all_comps_r.csv")
all_results <- read.csv("all_results.csv")
all_names <- read.csv("all_names.csv")
all_results <- all_results[all_results['speed']>50 & all_results['speed']<115,]
all_results <- all_results[all_results['dist']>40,]
dataset <- merge(all_results,all_comps_r,by=c('id'),all.y=FALSE)
dataset['short_id'] <- apply(dataset['id'], 2, substr ,start=1, stop=10)
short_ratings <- all_ratings
short_ratings['short_id'] <- apply(short_ratings['id'], 2, substr ,start=1, stop=10)
short_ratings <- short_ratings[!duplicated(short_ratings[,c('short_id','codex')]),c('short_id','codex','cumm_rating')]
dataset['norm_dist'] = dataset['dist']/dataset['hill_size_x']
dataset <- merge(dataset,short_ratings,by.x=c('short_id','codex.x'),by.y=c('short_id','codex'),all.y=FALSE,all.x=TRUE)
dataset$gender = as.integer(as.factor(dataset$gender))
dataset$date_new = as.integer(as.Date.character(dataset$date))
train_dataset = dataset[(dataset['season']>2010) & (dataset['season']>2016),]
require(tidyverse)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
test_dataset_1['prediction','dist']
require(tidyverse)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
test_dataset_1[['prediction','dist']]
require(tidyverse)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
test_dataset_1[c('prediction','dist'),]
require(tidyverse)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
test_dataset_1['prediction']
require(tidyverse)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
kable(test_dataset_1['prediction'])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
kable(test_dataset_1['prediction'])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
kable(test_dataset_1['dist','prediction'])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
kable(test_dataset_1[['dist','prediction']])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
kable(test_dataset_1[c('dist','prediction'),])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
kable(test_dataset_1[,c('dist','prediction')])
View(all_names)
View(test_dataset_1)
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1 = merge(all_names,how='left',by.x='codex.x',by.y='codex')
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1 %>% merge(all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
kable(test_dataset_1[,c('dist','prediction')])
View(test_dataset_1)
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1 %>% merge(all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
kable(test_dataset_1[,c('dist','prediction')])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1 = merge(test_dataset_1, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
kable(test_dataset_1[,c('dist','prediction')])
View(test_dataset_1)
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1 = merge(test_dataset_1, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
kable(test_dataset_1[,c('name','round','dist','prediction')])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1 = merge(test_dataset_1, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
test_dataset_1['prediction'] = floor(2*test_dataset_1['prediction'])/2
kable(test_dataset_1[,c('name','round','dist','prediction')])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1 = merge(test_dataset_1, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
test_dataset_1['prediction'] = round(2*test_dataset_1['prediction'])/2
kable(test_dataset_1[,c('name','round','dist','prediction')])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[2], id))
test_dataset_1 = merge(test_dataset_1, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
test_dataset_1['prediction'] = round(2*test_dataset_1['prediction'])/2
kable(test_dataset_1[,c('name','round','dist','prediction')])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[3], id))
test_dataset_1 = merge(test_dataset_1, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset_1['prediction'] = predict(simple_model,test_dataset_1)*test_dataset_1['hill_size_x']
test_dataset_1['prediction'] = round(2*test_dataset_1['prediction'])/2
kable(test_dataset_1[,c('name','round','dist','prediction')])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[3], id))
test_dataset_1 = merge(test_dataset_1, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset_1['prediction'] = predict(model,test_dataset_1)*test_dataset_1['hill_size_x']
test_dataset_1['prediction'] = round(2*test_dataset_1['prediction'])/2
kable(test_dataset_1[,c('name','round','dist','prediction')])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[2], id))
test_dataset_1 = merge(test_dataset_1, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset_1['prediction'] = predict(model,test_dataset_1)*test_dataset_1['hill_size_x']
test_dataset_1['prediction'] = round(2*test_dataset_1['prediction'])/2
kable(test_dataset_1[,c('name','round','dist','prediction')])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1 = merge(test_dataset_1, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset_1['prediction'] = predict(model,test_dataset_1)*test_dataset_1['hill_size_x']
test_dataset_1['prediction'] = round(2*test_dataset_1['prediction'])/2
kable(test_dataset_1[,c('name','round','dist','prediction')])
knitr::opts_chunk$set(echo = TRUE)
all_ratings <- read.csv("all_ratings.csv")
all_comps_r <- read.csv("all_comps_r.csv")
all_results <- read.csv("all_results.csv")
all_names <- read.csv("all_names.csv")
all_names <- all_names[!duplicated(all_names[,c('codex')]),]
all_results <- all_results[all_results['speed']>50 & all_results['speed']<115,]
all_results <- all_results[all_results['dist']>40,]
dataset <- merge(all_results,all_comps_r,by=c('id'),all.y=FALSE)
dataset['short_id'] <- apply(dataset['id'], 2, substr ,start=1, stop=10)
short_ratings <- all_ratings
short_ratings['short_id'] <- apply(short_ratings['id'], 2, substr ,start=1, stop=10)
short_ratings <- short_ratings[!duplicated(short_ratings[,c('short_id','codex')]),c('short_id','codex','cumm_rating')]
dataset['norm_dist'] = dataset['dist']/dataset['hill_size_x']
dataset <- merge(dataset,short_ratings,by.x=c('short_id','codex.x'),by.y=c('short_id','codex'),all.y=FALSE,all.x=TRUE)
dataset$gender = as.integer(as.factor(dataset$gender))
dataset$date_new = as.integer(as.Date.character(dataset$date))
train_dataset = dataset[(dataset['season']>2010) & (dataset['season']>2016),]
simple_model <- lm(norm_dist~speed+wind+hill_size_x+cumm_rating+gender+date_new+training, data=train_dataset)
summary(simple_model)
hist(train_dataset$norm_dist)
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1 = merge(test_dataset_1, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset_1['prediction'] = predict(model,test_dataset_1)*test_dataset_1['hill_size_x']
library(mgcv) # contains our prime model
model<-gam(norm_dist~s(speed)+wind+hill_size_x+s(cumm_rating)+gender+training+s(date_new), data=train_dataset)
summary(model)
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset_1 = dataset %>% filter(grepl(codes[1], id))
test_dataset_1 = merge(test_dataset_1, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset_1['prediction'] = predict(model,test_dataset_1)*test_dataset_1['hill_size_x']
test_dataset_1['prediction'] = round(2*test_dataset_1['prediction'])/2
kable(test_dataset_1[,c('name','round','dist','prediction')])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
test_dataset = dataset %>% filter(grepl(codes[1], id))
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
predict_comp(code[1])
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
predict_comp(code[1],dataset)
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
predict_comp(codes[1],dataset)
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
for(code in codes) predict_comp(code,dataset)
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
for(i in 1:length(codes)) predict_comp(codes[i],dataset)
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
for(i in 1:length(codes)){predict_comp(codes[i],dataset)}
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
predict_comp(codes[1],dataset)
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
print(predict_comp(codes[1],dataset))
predict_comp(codes[2],dataset)
predict_comp(codes[3],dataset)
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
for(code in codes) print(predict_comp(codes[i],dataset))
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
for(code in codes) print(predict_comp(code,dataset))
?sort
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = test_dataset[order(-bib,round),]
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
for(code in codes) print(predict_comp(code,dataset))
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = test_dataset[order(-test_dataset$bib,test_dataset$round),]
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
for(code in codes) print(predict_comp(code,dataset))
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = test_dataset[,order(-test_dataset$bib,test_dataset$round)]
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
for(code in codes) print(predict_comp(code,dataset))
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = test_dataset[,order(bib,round)]
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
for(code in codes) print(predict_comp(code,dataset))
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = test_dataset %>% arrange(desc(bib),round)
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
for(code in codes) print(predict_comp(code,dataset))
test_dataset %>% arrange(desc(bib),round)
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset = test_dataset %>% arrange(desc(cumm_rating),round)
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
for(code in codes) print(predict_comp(code,dataset))
\test_dataset %>% arrange(desc(cumm_rating),round)
test_dataset %>% arrange(desc(cumm_rating),round)
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id))
test_dataset %>% arrange(desc(cumm_rating),round)
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
for(code in codes) print(predict_comp(code,dataset))
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id)) %>% arrange(desc(cumm_rating),round)
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
kable(test_dataset[,c('name','round','dist','prediction')])
}
for(code in codes) print(predict_comp(code,dataset))
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id)) %>% arrange(desc(cumm_rating),round)
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
test_dataset['error'] = test_dataset['dist'] - test_dataset['prediction']
kable(test_dataset[,c('name','round','dist','prediction','error')])
}
for(code in codes) print(predict_comp(code,dataset))
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id)) %>% arrange(desc(cumm_rating),round)
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
test_dataset['error'] = test_dataset['dist'] - test_dataset['prediction']
kable(test_dataset[,c('name','round','dist','prediction','error')])
}
for(code in codes) print(predict_comp(code,dataset))
View(all_comps_r)
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL','2021JP3036RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id)) %>% arrange(desc(cumm_rating),round)
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
test_dataset['error'] = test_dataset['dist'] - test_dataset['prediction']
kable(test_dataset[,c('name','round','dist','prediction','error')])
}
for(code in codes) print(predict_comp(code,dataset))
require(tidyverse)
require(knitr)
codes = c('2017JP3817RL','2019JP3192RL','2018JP3265RL')
predict_comp <- function(code, dataset){
test_dataset = dataset %>% filter(grepl(code, id)) %>% arrange(desc(cumm_rating),round)
test_dataset = merge(test_dataset, all_names,how='left',by.x='codex.x',by.y='codex')
test_dataset['prediction'] = predict(simple_model,test_dataset)*test_dataset['hill_size_x']
test_dataset['prediction'] = round(2*test_dataset['prediction'])/2
test_dataset['error'] = test_dataset['dist'] - test_dataset['prediction']
kable(test_dataset[,c('name','round','dist','prediction','error')])
}
for(code in codes) print(predict_comp(code,dataset))
