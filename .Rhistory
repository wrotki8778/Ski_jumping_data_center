knitr::opts_chunk$set(echo = TRUE)
large_hill_data = subset(merge(results[,c('dist','id')],competitions[,c('id','size')],by='id'), dist>0, size='large')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(e1071)
competitions = read.csv2('all_comps_r.csv',sep=',',dec='.',stringsAsFactors = TRUE)
results = read.csv2('all_results.csv',sep=',',dec='.')
names = read.csv2('all_names.csv',sep=',',dec='.',stringsAsFactors = TRUE)
summary(competitions)
summary(results)
counts <- as.data.frame(table(competitions$place,competitions$gender))
counts_raw <- counts[aggregate(Freq ~ Var1,counts, sum)$Freq>50,]
counts <- filter(counts,counts$Var1 %in% counts_raw$Var1)
counts %>%
mutate(Var1 = fct_reorder(Var1,Freq,sum)) %>%
ggplot(aes(x=Var1, y=Freq, fill=Var2)) +
geom_bar(stat="identity", alpha=.6, width=.4) +
coord_flip() +
scale_fill_discrete(name = "Gender") +
xlab("") +
theme_bw()
countries <- as.data.frame(table(competitions$country,competitions$gender))
countries_raw <- countries[aggregate(Freq ~ Var1,countries, sum)$Freq>50,]
countries <- filter(countries,countries$Var1 %in% countries_raw$Var1)
countries %>%
mutate(Var1 = fct_reorder(Var1,Freq,sum)) %>%
ggplot(aes(x=Var1, y=Freq, fill=Var2)) +
geom_bar(stat="identity", alpha=.6, width=.4) +
coord_flip() +
scale_fill_discrete(name = "Gender") +
xlab("") +
theme_bw()
competitions['type_str'] = cut(competitions$type, breaks = c(-0.5,0.5,1.5,2.5,3.5,5.5), labels=c('WC', 'COC', 'GP','FC','Other'))
types <- as.data.frame(table(competitions$place,competitions$type_str))
types_raw <- types[aggregate(Freq ~ Var1,types, sum)$Freq>100,]
types <- filter(types,types$Var1 %in% types_raw$Var1)
types %>%
mutate(Var1 = fct_reorder(Var1,Freq,sum)) %>%
ggplot(aes(x=Var1, y=Freq, fill=Var2)) +
geom_bar(stat="identity", alpha=.6, width=.4) +
scale_fill_discrete(name = "Type") +
coord_flip() +
xlab("") +
theme_bw()
competitions['size'] = cut(competitions$hill_size_x, breaks = c(0,85,120,160,300), labels=c('small', 'normal', 'large','flying hill'))
ggplot(subset(competitions, gender %in% c("Men", "Women"))) +
geom_bar(aes(x = size, color=gender),fill="white", alpha = 0.6, position="dodge")
ggplot(competitions) +
geom_bar(aes(x = size, color=type_str),fill="white", alpha = 0.6, position="dodge")
length(setdiff(competitions$id,results$id))
ggplot(subset(results, speed > 60 & speed < 120)) +
geom_density(aes(x = speed),fill="white", alpha = 0.6)
ggplot(subset(merge(results[,c('speed','id')],competitions,by='id'), speed > 60 & speed < 120)) +
geom_area(aes(x = speed, color=size),fill="white", alpha = 0.6, stat='bin', position = position_dodge())
ggplot(subset(results, dist>0)) +
geom_density(aes(x = dist),fill="white", alpha = 0.6)
ggplot(subset(merge(results[,c('dist','id')],competitions[,c('id','size')],by='id'), dist>0)) +
geom_area(aes(x = dist, color=size),fill="white", alpha = 0.6, stat='bin', position = position_dodge())
ggplot(subset(merge(results[,c('dist','id')],competitions[,c('id','size')],by='id'), dist>0)) +
geom_density(aes(x = dist, color=size),fill="white", alpha = 0.6)+labs(title='Normalized plots of conditional densities')
large_hill_data = subset(merge(results[,c('dist','id')],competitions[,c('id','size')],by='id'), dist>0, size='large')
skewness(large_hill_data$dist)
large_hill_data = subset(merge(results[,c('dist','id')],competitions[,c('id','size')],by='id'), dist>0, size='large')
summary(large_hill_data$dist)
skewness(large_hill_data$dist)
View(large_hill_data)
large_hill_data = subset(merge(results[,c('dist','id')],competitions[,c('id','size')],by='id'), dist>0 & size='large')
large_hill_data = subset(merge(results[,c('dist','id')],competitions[,c('id','size')],by='id'), dist>0 & size=='large')
summary(large_hill_data$dist)
skewness(large_hill_data$dist)
large_hill_data = subset(merge(results[,c('dist','id')],competitions[,c('id','size')],by='id'), dist>0 & size=='flying hill')
summary(large_hill_data$dist)
skewness(large_hill_data$dist)
large_hill_data = subset(merge(results[,c('dist','id')],competitions[,c('id','size')],by='id'), dist>0 & size=='normal')
summary(large_hill_data$dist)
skewness(large_hill_data$dist)
large_hill_data = subset(merge(results[,c('dist','id')],competitions[,c('id','size')],by='id'), dist>0 & size=='large')
summary(large_hill_data$dist)
skewness(large_hill_data$dist)
View(large_hill_data)
View(competitions)
View(results)
